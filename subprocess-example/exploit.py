from subprocess import call

CMD_BACKGROUND = "\\background"
CMD_COLOR = "\\color"
CSS_FILE = 'custom.css'

def parse_message(message):

    command = message.split(' ')

    if message.startswith(CMD_BACKGROUND):
        change_background(command[1])
    elif len(command) == 2 and command[0] == CMD_COLOR:
        change_color(command[1])
    else:
        print("Just a Message: " + message)

def change_background(color):
    print("Changing background to " + color)
    command = 'sed -i "s/background:.*/background: ' +  color + ';/g" ' + CSS_FILE
    print(command)
    call(command, shell=True, executable='/bin/bash')

def change_color(color):
    print("Changing color to " + color)
    command = 'sed -i "s/color:.*/color: ' + color + ';/g" ' + CSS_FILE
    call(command, shell=True, executable='/bin/bash')

if __name__ == '__main__':
    parse_message("\\color #123")
    parse_message("\\background $({echo,$({cat,/home/silvan/Code/netsec/netsec16/backend/django/chat/settings.py})})")
